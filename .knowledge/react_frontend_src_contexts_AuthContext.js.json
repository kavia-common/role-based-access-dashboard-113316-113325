{"is_source_file": true, "format": "JavaScript", "description": "This file defines an authentication context for a React frontend application, including user session management, role-based access control (RBAC), organization memberships, and authentication operations with Supabase.", "external_files": ["../config/supabase"], "external_methods": ["supabase.auth.getSession", "supabase.auth.onAuthStateChange", "supabase.auth.signUp", "supabase.auth.signInWithPassword", "supabase.auth.signOut", "supabase.auth.resetPasswordForEmail", "supabase.from"], "published": ["PERMISSIONS_MATRIX", "AuthProvider", "useAuth"], "classes": [], "methods": [{"name": "getOrgMemberships", "description": "Fetches the organizations the user belongs to, including roles and organization info."}, {"name": "getGlobalRole", "description": "Retrieves the user's global role from the profiles table."}, {"name": "getUserProfile", "description": "Fetches detailed user profile information."}, {"name": "selectOrg", "description": "Sets the current active organization context for the user."}, {"name": "isSuperAdmin", "description": "Checks if the user has the super_admin global role."}, {"name": "hasOrgRole", "description": "Checks if the user has a specific role within the active organization."}, {"name": "getEffectiveRole", "description": "Determines the user's effective role, prioritizing super_admin status."}, {"name": "hasPermission", "description": "Checks whether the user has permission for a specific action based on role."}, {"name": "isAuthenticated", "description": "Checks if a user is currently authenticated."}, {"name": "getOrgs", "description": "Returns a list of organizations the user belongs to."}, {"name": "getCurrentOrg", "description": "Returns the current active organization."}, {"name": "getOrgRole", "description": "Returns the role of the user in the current organization."}, {"name": "getUser", "description": "Returns the current user object."}, {"name": "getSession", "description": "Returns the current authentication session."}, {"name": "signUp", "description": "Registers a new user with email and password."}, {"name": "signIn", "description": "Authenticates a user with email and password."}, {"name": "signOut", "description": "Signs the user out, clearing all session and role data."}, {"name": "resetPassword", "description": "Initiates password reset process via email."}], "calls": ["supabase.auth.getSession", "supabase.auth.onAuthStateChange", "supabase.auth.signUp", "supabase.auth.signInWithPassword", "supabase.auth.signOut", "supabase.auth.resetPasswordForEmail", "supabase.from"], "search-terms": ["AuthContext", "Permissions Matrix", "useAuth", "supabase", "AuthProvider", "RBAC", "organization memberships", "session management", "React Context"], "state": 2, "file_id": 15, "knowledge_revision": 82, "git_revision": "2ff23185c89c3184d2dad5cd37f671695f3884f9", "revision_history": [{"30": ""}, {"82": "2ff23185c89c3184d2dad5cd37f671695f3884f9"}], "ctags": [{"_type": "tag", "name": "AuthContext", "path": "/home/kavia/workspace/code-generation/role-based-access-dashboard-113316-113325/react_frontend/src/contexts/AuthContext.js", "pattern": "/^const AuthContext = createContext({});$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "AuthProvider", "path": "/home/kavia/workspace/code-generation/role-based-access-dashboard-113316-113325/react_frontend/src/contexts/AuthContext.js", "pattern": "/^export const AuthProvider = ({ children }) => {$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "PERMISSIONS_MATRIX", "path": "/home/kavia/workspace/code-generation/role-based-access-dashboard-113316-113325/react_frontend/src/contexts/AuthContext.js", "pattern": "/^export const PERMISSIONS_MATRIX = {$/", "language": "JavaScript", "kind": "class"}, {"_type": "tag", "name": "can", "path": "/home/kavia/workspace/code-generation/role-based-access-dashboard-113316-113325/react_frontend/src/contexts/AuthContext.js", "pattern": "/^    can: ['manage_org_users', 'view_org_dashboard', 'invite_org_users'],$/", "language": "JavaScript", "kind": "property", "scope": "PERMISSIONS_MATRIX.org_admin", "scopeKind": "class"}, {"_type": "tag", "name": "can", "path": "/home/kavia/workspace/code-generation/role-based-access-dashboard-113316-113325/react_frontend/src/contexts/AuthContext.js", "pattern": "/^    can: ['manage_orgs', 'manage_users', 'view_all', 'invite_anyone'],$/", "language": "JavaScript", "kind": "property", "scope": "PERMISSIONS_MATRIX.super_admin", "scopeKind": "class"}, {"_type": "tag", "name": "can", "path": "/home/kavia/workspace/code-generation/role-based-access-dashboard-113316-113325/react_frontend/src/contexts/AuthContext.js", "pattern": "/^    can: ['view_org_dashboard'],$/", "language": "JavaScript", "kind": "property", "scope": "PERMISSIONS_MATRIX.org_user", "scopeKind": "class"}, {"_type": "tag", "name": "can", "path": "/home/kavia/workspace/code-generation/role-based-access-dashboard-113316-113325/react_frontend/src/contexts/AuthContext.js", "pattern": "/^    can: [],$/", "language": "JavaScript", "kind": "property", "scope": "PERMISSIONS_MATRIX.guest", "scopeKind": "class"}, {"_type": "tag", "name": "children", "path": "/home/kavia/workspace/code-generation/role-based-access-dashboard-113316-113325/react_frontend/src/contexts/AuthContext.js", "pattern": "/^export const AuthProvider = ({ children }) => {$/", "language": "JavaScript", "kind": "field", "scope": "AuthProvider", "scopeKind": "class"}, {"_type": "tag", "name": "context", "path": "/home/kavia/workspace/code-generation/role-based-access-dashboard-113316-113325/react_frontend/src/contexts/AuthContext.js", "pattern": "/^  const context = useContext(AuthContext);$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "description", "path": "/home/kavia/workspace/code-generation/role-based-access-dashboard-113316-113325/react_frontend/src/contexts/AuthContext.js", "pattern": "/^    description: 'Admin of a specific org. Can manage users within their org.',$/", "language": "JavaScript", "kind": "property", "scope": "PERMISSIONS_MATRIX.org_admin", "scopeKind": "class"}, {"_type": "tag", "name": "description", "path": "/home/kavia/workspace/code-generation/role-based-access-dashboard-113316-113325/react_frontend/src/contexts/AuthContext.js", "pattern": "/^    description: 'Global super admin. Can manage all organizations and users.',$/", "language": "JavaScript", "kind": "property", "scope": "PERMISSIONS_MATRIX.super_admin", "scopeKind": "class"}, {"_type": "tag", "name": "description", "path": "/home/kavia/workspace/code-generation/role-based-access-dashboard-113316-113325/react_frontend/src/contexts/AuthContext.js", "pattern": "/^    description: 'Limited access, typically just authenticated.',$/", "language": "JavaScript", "kind": "property", "scope": "PERMISSIONS_MATRIX.guest", "scopeKind": "class"}, {"_type": "tag", "name": "description", "path": "/home/kavia/workspace/code-generation/role-based-access-dashboard-113316-113325/react_frontend/src/contexts/AuthContext.js", "pattern": "/^    description: 'User within the organization. Can view and interact with org dashboards.',$/", "language": "JavaScript", "kind": "property", "scope": "PERMISSIONS_MATRIX.org_user", "scopeKind": "class"}, {"_type": "tag", "name": "getCurrentOrg", "path": "/home/kavia/workspace/code-generation/role-based-access-dashboard-113316-113325/react_frontend/src/contexts/AuthContext.js", "pattern": "/^  const getCurrentOrg = () => currentOrg;$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "getEffectiveRole", "path": "/home/kavia/workspace/code-generation/role-based-access-dashboard-113316-113325/react_frontend/src/contexts/AuthContext.js", "pattern": "/^  const getEffectiveRole = () => {$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "getGlobalRole", "path": "/home/kavia/workspace/code-generation/role-based-access-dashboard-113316-113325/react_frontend/src/contexts/AuthContext.js", "pattern": "/^  const getGlobalRole = async (userId) => {$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "getOrgMemberships", "path": "/home/kavia/workspace/code-generation/role-based-access-dashboard-113316-113325/react_frontend/src/contexts/AuthContext.js", "pattern": "/^  const getOrgMemberships = async (userId) => {$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "getOrgRole", "path": "/home/kavia/workspace/code-generation/role-based-access-dashboard-113316-113325/react_frontend/src/contexts/AuthContext.js", "pattern": "/^  const getOrgRole = () => roleInOrg;$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "getOrgs", "path": "/home/kavia/workspace/code-generation/role-based-access-dashboard-113316-113325/react_frontend/src/contexts/AuthContext.js", "pattern": "/^  const getOrgs = () => orgMemberships.map((m) => ({$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "getSession", "path": "/home/kavia/workspace/code-generation/role-based-access-dashboard-113316-113325/react_frontend/src/contexts/AuthContext.js", "pattern": "/^  const getSession = () => session;$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "getUser", "path": "/home/kavia/workspace/code-generation/role-based-access-dashboard-113316-113325/react_frontend/src/contexts/AuthContext.js", "pattern": "/^  const getUser = () => user;$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "getUserProfile", "path": "/home/kavia/workspace/code-generation/role-based-access-dashboard-113316-113325/react_frontend/src/contexts/AuthContext.js", "pattern": "/^  const getUserProfile = async (userId) => {$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "guest", "path": "/home/kavia/workspace/code-generation/role-based-access-dashboard-113316-113325/react_frontend/src/contexts/AuthContext.js", "pattern": "/^  guest: {$/", "language": "JavaScript", "kind": "class", "scope": "PERMISSIONS_MATRIX", "scopeKind": "class"}, {"_type": "tag", "name": "hasOrgRole", "path": "/home/kavia/workspace/code-generation/role-based-access-dashboard-113316-113325/react_frontend/src/contexts/AuthContext.js", "pattern": "/^  const hasOrgRole = (role) => roleInOrg === role;$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "hasPermission", "path": "/home/kavia/workspace/code-generation/role-based-access-dashboard-113316-113325/react_frontend/src/contexts/AuthContext.js", "pattern": "/^  const hasPermission = (permission) => {$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "isAuthenticated", "path": "/home/kavia/workspace/code-generation/role-based-access-dashboard-113316-113325/react_frontend/src/contexts/AuthContext.js", "pattern": "/^  const isAuthenticated = () => !!user && !!session;$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "isSuperAdmin", "path": "/home/kavia/workspace/code-generation/role-based-access-dashboard-113316-113325/react_frontend/src/contexts/AuthContext.js", "pattern": "/^  const isSuperAdmin = () => globalRole === 'super_admin';$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "org", "path": "/home/kavia/workspace/code-generation/role-based-access-dashboard-113316-113325/react_frontend/src/contexts/AuthContext.js", "pattern": "/^    const org = orgMemberships.find((m) => m.org_id === orgId);$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "orgScope", "path": "/home/kavia/workspace/code-generation/role-based-access-dashboard-113316-113325/react_frontend/src/contexts/AuthContext.js", "pattern": "/^    orgScope: false,$/", "language": "JavaScript", "kind": "property", "scope": "PERMISSIONS_MATRIX.guest", "scopeKind": "class"}, {"_type": "tag", "name": "orgScope", "path": "/home/kavia/workspace/code-generation/role-based-access-dashboard-113316-113325/react_frontend/src/contexts/AuthContext.js", "pattern": "/^    orgScope: false,$/", "language": "JavaScript", "kind": "property", "scope": "PERMISSIONS_MATRIX.super_admin", "scopeKind": "class"}, {"_type": "tag", "name": "orgScope", "path": "/home/kavia/workspace/code-generation/role-based-access-dashboard-113316-113325/react_frontend/src/contexts/AuthContext.js", "pattern": "/^    orgScope: true,$/", "language": "JavaScript", "kind": "property", "scope": "PERMISSIONS_MATRIX.org_admin", "scopeKind": "class"}, {"_type": "tag", "name": "orgScope", "path": "/home/kavia/workspace/code-generation/role-based-access-dashboard-113316-113325/react_frontend/src/contexts/AuthContext.js", "pattern": "/^    orgScope: true,$/", "language": "JavaScript", "kind": "property", "scope": "PERMISSIONS_MATRIX.org_user", "scopeKind": "class"}, {"_type": "tag", "name": "org_admin", "path": "/home/kavia/workspace/code-generation/role-based-access-dashboard-113316-113325/react_frontend/src/contexts/AuthContext.js", "pattern": "/^  org_admin: {$/", "language": "JavaScript", "kind": "class", "scope": "PERMISSIONS_MATRIX", "scopeKind": "class"}, {"_type": "tag", "name": "org_user", "path": "/home/kavia/workspace/code-generation/role-based-access-dashboard-113316-113325/react_frontend/src/contexts/AuthContext.js", "pattern": "/^  org_user: {$/", "language": "JavaScript", "kind": "class", "scope": "PERMISSIONS_MATRIX", "scopeKind": "class"}, {"_type": "tag", "name": "perms", "path": "/home/kavia/workspace/code-generation/role-based-access-dashboard-113316-113325/react_frontend/src/contexts/AuthContext.js", "pattern": "/^    const perms = PERMISSIONS_MATRIX[role]?.can || [];$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "resetPassword", "path": "/home/kavia/workspace/code-generation/role-based-access-dashboard-113316-113325/react_frontend/src/contexts/AuthContext.js", "pattern": "/^  const resetPassword = async (email) => {$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "role", "path": "/home/kavia/workspace/code-generation/role-based-access-dashboard-113316-113325/react_frontend/src/contexts/AuthContext.js", "pattern": "/^    const role = getEffectiveRole();$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "selectOrg", "path": "/home/kavia/workspace/code-generation/role-based-access-dashboard-113316-113325/react_frontend/src/contexts/AuthContext.js", "pattern": "/^  const selectOrg = (orgId) => {$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "setCurrentOrg", "path": "/home/kavia/workspace/code-generation/role-based-access-dashboard-113316-113325/react_frontend/src/contexts/AuthContext.js", "pattern": "/^  const [currentOrg, setCurrentOrg] = useState(null); \\/\\/ Currently active org (object: {id, na/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "setGlobalRole", "path": "/home/kavia/workspace/code-generation/role-based-access-dashboard-113316-113325/react_frontend/src/contexts/AuthContext.js", "pattern": "/^  const [globalRole, setGlobalRole] = useState(null); \\/\\/ super_admin, etc.$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "setLoading", "path": "/home/kavia/workspace/code-generation/role-based-access-dashboard-113316-113325/react_frontend/src/contexts/AuthContext.js", "pattern": "/^  const [loading, setLoading] = useState(true);$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "setOrgMemberships", "path": "/home/kavia/workspace/code-generation/role-based-access-dashboard-113316-113325/react_frontend/src/contexts/AuthContext.js", "pattern": "/^  const [orgMemberships, setOrgMemberships] = useState([]); \\/\\/ List of orgs user belongs to$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "setRoleInOrg", "path": "/home/kavia/workspace/code-generation/role-based-access-dashboard-113316-113325/react_frontend/src/contexts/AuthContext.js", "pattern": "/^  const [roleInOrg, setRoleInOrg] = useState(null); \\/\\/ Role of user in active org$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "setSession", "path": "/home/kavia/workspace/code-generation/role-based-access-dashboard-113316-113325/react_frontend/src/contexts/AuthContext.js", "pattern": "/^  const [session, setSession] = useState(null);$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "setUser", "path": "/home/kavia/workspace/code-generation/role-based-access-dashboard-113316-113325/react_frontend/src/contexts/AuthContext.js", "pattern": "/^  const [user, setUser] = useState(null);$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "setUserProfile", "path": "/home/kavia/workspace/code-generation/role-based-access-dashboard-113316-113325/react_frontend/src/contexts/AuthContext.js", "pattern": "/^  const [userProfile, setUserProfile] = useState(null);$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "signIn", "path": "/home/kavia/workspace/code-generation/role-based-access-dashboard-113316-113325/react_frontend/src/contexts/AuthContext.js", "pattern": "/^  const signIn = async (email, password) => {$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "signOut", "path": "/home/kavia/workspace/code-generation/role-based-access-dashboard-113316-113325/react_frontend/src/contexts/AuthContext.js", "pattern": "/^  const signOut = async () => {$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "signUp", "path": "/home/kavia/workspace/code-generation/role-based-access-dashboard-113316-113325/react_frontend/src/contexts/AuthContext.js", "pattern": "/^  const signUp = async (email, password, options = {}) => {$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "super_admin", "path": "/home/kavia/workspace/code-generation/role-based-access-dashboard-113316-113325/react_frontend/src/contexts/AuthContext.js", "pattern": "/^  super_admin: {$/", "language": "JavaScript", "kind": "class", "scope": "PERMISSIONS_MATRIX", "scopeKind": "class"}, {"_type": "tag", "name": "useAuth", "path": "/home/kavia/workspace/code-generation/role-based-access-dashboard-113316-113325/react_frontend/src/contexts/AuthContext.js", "pattern": "/^export const useAuth = () => {$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "user", "path": "/home/kavia/workspace/code-generation/role-based-access-dashboard-113316-113325/react_frontend/src/contexts/AuthContext.js", "pattern": "/^    user,$/", "language": "JavaScript", "kind": "field", "scope": "value", "scopeKind": "class"}, {"_type": "tag", "name": "value", "path": "/home/kavia/workspace/code-generation/role-based-access-dashboard-113316-113325/react_frontend/src/contexts/AuthContext.js", "pattern": "/^    <AuthContext.Provider value={value}>$/", "language": "JavaScript", "kind": "field", "scope": "Provider", "scopeKind": "class"}, {"_type": "tag", "name": "value", "path": "/home/kavia/workspace/code-generation/role-based-access-dashboard-113316-113325/react_frontend/src/contexts/AuthContext.js", "pattern": "/^  const value = {$/", "language": "JavaScript", "kind": "constant"}], "hash": "12e9eaff13377218f539dff3996f44df", "format-version": 4, "code-base-name": "react_frontend", "filename": "react_frontend/src/contexts/AuthContext.js", "fields": [{"name": "can: ['manage_org_users', 'view_org_dashboard', 'invite_org_users'],", "scope": "PERMISSIONS_MATRIX.org_admin", "scopeKind": "class", "description": "unavailable"}, {"name": "can: ['manage_orgs', 'manage_users', 'view_all', 'invite_anyone'],", "scope": "PERMISSIONS_MATRIX.super_admin", "scopeKind": "class", "description": "unavailable"}, {"name": "can: ['view_org_dashboard'],", "scope": "PERMISSIONS_MATRIX.org_user", "scopeKind": "class", "description": "unavailable"}, {"name": "can: [],", "scope": "PERMISSIONS_MATRIX.guest", "scopeKind": "class", "description": "unavailable"}, {"name": "export const AuthProvider = ({ children }) => {", "scope": "AuthProvider", "scopeKind": "class", "description": "unavailable"}, {"name": "description: 'Admin of a specific org. Can manage users within their org.',", "scope": "PERMISSIONS_MATRIX.org_admin", "scopeKind": "class", "description": "unavailable"}, {"name": "description: 'Global super admin. Can manage all organizations and users.',", "scope": "PERMISSIONS_MATRIX.super_admin", "scopeKind": "class", "description": "unavailable"}, {"name": "description: 'Limited access, typically just authenticated.',", "scope": "PERMISSIONS_MATRIX.guest", "scopeKind": "class", "description": "unavailable"}, {"name": "description: 'User within the organization. Can view and interact with org dashboards.',", "scope": "PERMISSIONS_MATRIX.org_user", "scopeKind": "class", "description": "unavailable"}, {"name": "orgScope: false,", "scope": "PERMISSIONS_MATRIX.guest", "scopeKind": "class", "description": "unavailable"}, {"name": "orgScope: true,", "scope": "PERMISSIONS_MATRIX.org_admin", "scopeKind": "class", "description": "unavailable"}, {"name": "user,", "scope": "value", "scopeKind": "class", "description": "unavailable"}, {"name": "<AuthContext.Provider value={value}>", "scope": "Provider", "scopeKind": "class", "description": "unavailable"}]}